<!DOCTYPE html>
<html lang="az"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}"
      xmlns:sec="http://www.w3.org/1999/xhtml">

<body>
<main layout:fragment="content">

    <!-- Hero Start -->
    <div class="container-fluid bg-light page-header py-5 mb-5">
        <div class="container text-center py-5">
            <h1 class="display-1 animated slideInLeft">Əlaqə</h1>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb justify-content-center animated slideInLeft mb-0">
                    <li class="breadcrumb-item"><a class="text-primary" href="/">Ana səhifə</a></li>
                    <li class="breadcrumb-item active" aria-current="page">Əlaqə</li>
                </ol>
            </nav>
        </div>
    </div>
    <!-- Hero End -->

    <!-- Contact Start -->
    <div class="container-fluid py-5">
        <div class="container">
            <div class="row g-5">
                <div class="col-lg-6 wow fadeIn" data-wow-delay="0.1s">
                    <h1 class="mb-4">Bizimlə əlaqə saxlayın</h1>
                    <p class="mb-4">Sizə xidmət etməkdən məmnun olarıq. Zəhmət olmasa mesajınızı buradan göndərin.</p>

                    <form action="/contact" method="post">
                        <div class="row g-3">
                            <!-- Ad -->
                            <div class="col-md-6">
                                <input type="text" class="form-control" name="name" placeholder="Adınız" required sec:authorize="isAuthenticated()">
                                <input type="text" class="form-control" placeholder="Adınız" required onfocus="showLoginModal()" sec:authorize="isAnonymous()">
                            </div>

                            <!-- Mövzu -->
                            <div class="col-md-6">
                                <input type="text" class="form-control" name="subject" placeholder="Mövzu" required sec:authorize="isAuthenticated()">
                                <input type="text" class="form-control" placeholder="Mövzu" required onfocus="showLoginModal()" sec:authorize="isAnonymous()">
                            </div>

                            <!-- Mesaj -->
                            <div class="col-12">
                                <textarea class="form-control" name="message" rows="5" placeholder="Mesajınız" required sec:authorize="isAuthenticated()"></textarea>
                                <textarea class="form-control" rows="5" placeholder="Mesajınız" required onfocus="showLoginModal()" sec:authorize="isAnonymous()"></textarea>
                            </div>

                            <!-- Submit -->
                            <div class="col-12">
                                <button class="btn btn-primary w-100 py-3" type="submit">Göndər</button>
                            </div>
                        </div>
                    </form>

                    <!-- Login Modal -->
                    <div class="modal fade" id="loginModal" tabindex="-1" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">
                                <div class="modal-header bg-light">
                                    <h5 class="modal-title">Daxil ol</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                </div>
                                <div class="modal-body">
                                    <form th:action="@{/perform_login}" method="post">
                                        <div class="mb-3">
                                            <input type="text" class="form-control" name="username" placeholder="E-Poçt" required>
                                        </div>
                                        <div class="mb-3">
                                            <input type="password" class="form-control" name="password" placeholder="Şifrə" required>
                                        </div>
                                        <button type="submit" class="btn btn-primary w-100">Daxil ol</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Success Modal -->
                    <div class="modal fade" id="successModal" tabindex="-1" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">
                                <div class="modal-header bg-success text-white">
                                    <h5 class="modal-title">Uğurlu əməliyyat</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                </div>
                                <div class="modal-body">
                                    Mesajınız uğurla göndərildi ✅
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Error Modal -->
                    <div class="modal fade" id="errorModal" tabindex="-1" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">
                                <div class="modal-header bg-danger text-white">
                                    <h5 class="modal-title">Xəta baş verdi</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                </div>
                                <div class="modal-body">
                                    Zəhmət olmasa yenidən cəhd edin ❌
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="col-lg-6 wow fadeIn" data-wow-delay="0.5s">
                    <iframe class="w-100 h-100"
                            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3038.847127735254!2d49.8516!3d40.3777!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x40307d0b0b0b0b0b%3A0x123456789abcdef!2sBaku!5e0!3m2!1sen!2saz!4v0000000000"
                            frameborder="0" allowfullscreen="" aria-hidden="false" tabindex="0"></iframe>
                </div>
            </div>
        </div>
    </div>
    <!-- Contact End -->

    <script th:inline="javascript">
        let success = [[${param.success != null}]];
        let error = [[${param.error != null}]];

        if (success) {
            var modal = new bootstrap.Modal(document.getElementById('successModal'));
            modal.show();
        }
        if (error) {
            var modal = new bootstrap.Modal(document.getElementById('errorModal'));
            modal.show();
        }
    </script>
    <script>
        function showLoginModal() {
            var modal = new bootstrap.Modal(document.getElementById('loginModal'));
            modal.show();
        }
    </script>

</main>
</body>
</html>
